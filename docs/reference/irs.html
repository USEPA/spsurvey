<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Select an independent random sample (IRS) — irs • spsurvey</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Select an independent random sample (IRS) — irs"><meta property="og:description" content="Select a sample that is not spatially balanced from a point (finite), linear / linestring (infinite),
or areal / polygon (infinite) sampling frame using the Independent Random Sampling (IRS) algorithm.
The IRS algorithm accommodates unstratified and
stratified sampling designs and allows for equal inclusion probabilities, unequal
inclusion probabilities according to a categorical variable, and inclusion
probabilities proportional to a positive auxiliary variable. Several additional
sampling options are included, such as including legacy (historical) sites,
requiring a minimum distance between sites, and selecting replacement sites."><meta property="og:image" content="https://usepa.github.io/spsurvey/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spsurvey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/start-here.html">Start Here</a>
    </li>
    <li>
      <a href="../articles/EDA.html">Summarizing and Visualizing Sampling Frames, Design Sites, and Analysis Data</a>
    </li>
    <li>
      <a href="../articles/sampling.html">Spatially Balanced Sampling</a>
    </li>
    <li>
      <a href="../articles/analysis.html">Analyzing Data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USEPA/spsurvey/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select an independent random sample (IRS)</h1>
    <small class="dont-index">Source: <a href="https://github.com/USEPA/spsurvey/blob/HEAD/R/irs.R" class="external-link"><code>R/irs.R</code></a></small>
    <div class="hidden name"><code>irs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Select a sample that is not spatially balanced from a point (finite), linear / linestring (infinite),
or areal / polygon (infinite) sampling frame using the Independent Random Sampling (IRS) algorithm.
The IRS algorithm accommodates unstratified and
stratified sampling designs and allows for equal inclusion probabilities, unequal
inclusion probabilities according to a categorical variable, and inclusion
probabilities proportional to a positive auxiliary variable. Several additional
sampling options are included, such as including legacy (historical) sites,
requiring a minimum distance between sites, and selecting replacement sites.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">irs</span><span class="op">(</span></span>
<span>  <span class="va">sframe</span>,</span>
<span>  <span class="va">n_base</span>,</span>
<span>  stratum_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seltype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  caty_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  caty_n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aux_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legacy_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legacy_sites <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legacy_stratum_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legacy_caty_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legacy_aux_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mindis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxtry <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n_over <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_near <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wgt_units <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_density <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  DesignID <span class="op">=</span> <span class="st">"Site"</span>,</span>
<span>  SiteBegin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>  projcrs_check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sframe</dt>
<dd><p>A sampling frame as an <code>sf</code> object. The coordinate
system for <code>sframe</code> must projected (not geographic). If m or z values
are in <code>sframe</code>'s geometry, they are silently dropped (i.e., only x-coordinates
and y-coordinates are preserved).</p></dd>


<dt>n_base</dt>
<dd><p>The base sample size required. If the sampling design is unstratified,
this is a single numeric value. If the sampling design is stratified, this is a named
vector or list whose names represent each stratum and whose values represent each
stratum's sample size. These names must match the values of the stratification
variable represented by <code>stratum_var</code>. Legacy sites are considered part
of the base sample, so the value for <code>n_base</code> should be equal to the number
of legacy sites plus the number of desired non-legacy sites.</p></dd>


<dt>stratum_var</dt>
<dd><p>A character string containing the name of the column from
<code>sframe</code> that identifies stratum membership for each element in <code>sframe</code>.
If stratum equals <code>NULL</code>, the sampling design is unstratified and all elements in <code>sframe</code>
are eligible to be selected in the sample. The default is <code>NULL</code>.</p></dd>


<dt>seltype</dt>
<dd><p>A character string or vector indicating the inclusion probability type,
which must be one of following: <code>"equal"</code> for equal inclusion probabilities;
<code>"unequal"</code> for unequal inclusion probabilities according to a categorical
variable specified by <code>caty_var</code>; and <code>"proportional"</code> for inclusion
probabilities proportional to a positive auxiliary variable specified by
<code>aux_var</code>. If the sampling design is unstratified, <code>seltype</code> is a single
character vector. If the sampling design is stratified, <code>seltype</code> is a named vector
whose names represent each stratum and whose values represent each stratum's
inclusion probability type. <code>seltype</code>'s default value tries to match the
intended inclusion probability type: If <code>caty_var</code> and <code>aux_var</code> are
not specified, <code>seltype</code> is <code>"equal"</code>; if <code>caty_var</code> is specified,
<code>seltype</code> is <code>"unequal"</code>; and if <code>aux_var</code> is specified, <code>seltype</code>
is <code>"proportional"</code>.</p></dd>


<dt>caty_var</dt>
<dd><p>A character string containing the name of the column from
<code>sframe</code> that represents the unequal probability variable.</p></dd>


<dt>caty_n</dt>
<dd><p>A character vector indicating the expected sample size for each
level of <code>caty_var</code>, the unequal probability variable. If the sampling design
is unstratified, <code>caty_n</code> is a named vector whose names represent each
level of <code>caty_var</code> and whose values represent each level's expected
sample size. The sum of <code>caty_n</code> must equal <code>n_base</code>. If the sampling design
is stratified and the expected sample sizes are the same among strata, <code>caty_n</code> is
a named vector whose names represent represent each
level of <code>caty_var</code> and whose values represent each level's expected
sample size -- these expected sample sizes are applied to all strata. The sum of
<code>caty_n</code> must equal each stratum's value in <code>n_base</code>.
If the sampling design is stratified and the expected sample sizes differ among strata,
<code>caty_n</code> is a list where each element  is named as a stratum in <code>n_base</code>.
Each stratum's list element is a named vector whose
names represent each level of <code>caty_var</code> and whose values represent each
level's expected sample size (within the stratum). The sum of the values in each stratum's
list element must equal that stratum's value in <code>n_base</code>.</p></dd>


<dt>aux_var</dt>
<dd><p>A character string containing the name of the column from
<code>sframe</code> that represents the proportional (to size) inclusion probability
variable (auxiliary variable). This auxiliary variable must be positive, and the resulting
inclusion probabilities are proportional to the values of the auxiliary variable.
Larger values of the auxiliary variable result in higher inclusion probabilities.</p></dd>


<dt>legacy_var</dt>
<dd><p>This argument can be used instead of <code>legacy_sites</code>
when <code>sframe</code> is a <code>POINT</code> or <code>MULTIPOINT</code>
geometry (i.e. a finite sampling frame),
When <code>legacy_var</code> is used, it is a character string containing the name of the column
from <code>sframe</code> that represents whether each site is a legacy site. For
legacy sites, the values of the <code>legacy_var</code> must contain character strings that
act as a legacy site identifier. For non-legacy sites, the values of the
<code>legacy_var</code> column must be <code>NA</code>. Using this approach,
<code>legacy_stratum_var</code>, <code>legacy_caty_var</code>, and <code>legacy_aux_var</code>
are not required and should not be used (because <code>legacy_var</code> represents a column
in <code>sframe</code>). <code>spsurvey</code> assumes that the legacy sites were selected from
a previous sampling design that incorporated randomness into site selection
and that the legacy sites are elements of the current sampling frame.</p></dd>


<dt>legacy_sites</dt>
<dd><p>An sf object with a <code>POINT</code> or <code>MULTIPOINT</code>
geometry representing the legacy sites. spsurvey assumes that
the legacy sites were selected from a previous sampling design that
incorporated randomness into site selection and that the legacy sites
are elements of the current sampling frame. If <code>sframe</code> has a
<code>POINT</code> or <code>MULTIPOINT</code> geometry, the observations in <code>legacy_sites</code>
should not also be in <code>sframe</code> (i.e., duplicates are not removed). Thus, <code>sframe</code>
and <code>legacy_sites</code> together compose the current sampling frame. If m or z values
are in <code>legacy_sites</code>' geometry, they are silently dropped (i.e., only x-coordinates
and y-coordinates are preserved).</p></dd>


<dt>legacy_stratum_var</dt>
<dd><p>A character string containing the name of the column from
<code>legacy_sites</code> that identifies stratum membership for each element of <code>legacy_sites</code>.
This argument is required when the sampling design is stratified and its levels
must be contained in the levels of the <code>stratum_var</code> variable. The default value of <code>legacy_stratum_var</code>
is <code>stratum_var</code>, so <code>legacy_stratum_var</code> need only be specified explicitly when
the name of the stratification variable in <code>legacy_sites</code> differs from <code>stratum_var</code>.</p></dd>


<dt>legacy_caty_var</dt>
<dd><p>A character string containing the name of the column from
<code>legacy_sites</code> that identifies the unequal probability variable for each element of <code>legacy_sites</code>.
This argument is required when the sampling design uses unequal selection probabilities and its categories
must be contained in the levels of the <code>caty_var</code> variable. The default value of <code>legacy_caty_var</code>
is <code>caty_var</code>, so <code>legacy_caty_var</code> need only be specified explicitly when
the name of the unequal probability variable in <code>legacy_sites</code> differs from <code>caty_var</code>.</p></dd>


<dt>legacy_aux_var</dt>
<dd><p>A character string containing the name of the column from
<code>legacy_sites</code> that identifies the proportional probability variable for each element of <code>legacy_sites</code>.
This argument is required when the sampling design uses proportional selection probabilities and the values of the
<code>legacy_aux_var</code> variable must be positive. The
default value of <code>legacy_aux_var</code> is <code>aux_var</code>, so <code>legacy_aux_var</code> need only be specified explicitly
when the name of the proportional probability variable in <code>legacy_sites</code> differs from <code>aux_var</code>.</p></dd>


<dt>mindis</dt>
<dd><p>A numeric value indicating the desired minimum distance between sampled
sites. If the sampling design is stratified and <code>mindis</code> is an numeric value, the minimum
distance is applied to all strata. If the sampling design is stratified and different minimum distances
are desired among strata, then <code>mindis</code>
is a list whose names match the names of <code>n_base</code> and whose and values
are the minimum distance for the corresponding stratum.  If a minimum distance is not desired
for a particular stratum, then the corresponding value in <code>mindis</code> should be <code>0</code> or
 <code>NULL</code> (which is equivalent to <code>0</code>).
The units of <code>mindis</code> must represent the units in <code>sframe</code>. A warning is returned if the
minimum distance could not be reached after <code>maxtry</code> attempts. If legacy sites are used, the minimum distance
requirement (and subsequent warning if <code>maxtry</code> attempts are reached) is enforced for all base sites
that are not legacy sites (i.e., the minimum distance is enforced for these sites
by comparing distances against all base sites (legacy and non-legacy)).</p></dd>


<dt>maxtry</dt>
<dd><p>The number of maximum attempts to apply the minimum distance algorithm to obtain
the desired minimum distance between sites. Each iteration takes roughly as long as the
standard GRTS algorithm. Successive iterations will always contain at least as many
sites satisfying the minimum distance requirement as the previous iteration. The algorithm stops
when the minimum distance requirement is met or there are <code>maxtry</code> iterations.
The default number of maximum iterations is <code>10</code>.</p></dd>


<dt>n_over</dt>
<dd><p>The number of reverse hierarchically ordered (rho) replacement sites.
 If the sampling design is unstratified, then
 <code>n_over</code> is an integer specifying the number of rho replacement sites desired.
If the sampling design is stratified,
 then <code>n_over</code> is a vector (or list) whose names match the names of <code>n_base</code> and
 whose values indicate the number of rho replacement sites for each stratum.
 If replacement sites are not desired for a particular stratum, then the corresponding
 value in <code>n_over</code> should be <code>0</code> or <code>NULL</code> (which is equivalent to <code>0</code>).
 If the sampling design is stratified but the number of <code>n_over</code> sites is the same in each
 stratum, <code>n_over</code> can be a vector which is used for each stratum.
 If <code>n_over</code> is an unnamed, length-one vector, it's value is recycled
 and used for each stratum. Note that if the
 sampling design has unequal selection probabilities (<code>seltype = "unequal"</code>), then <code>n_over</code> sites
 are given the same proportion of <code>caty_n</code> values as <code>n_base</code>.</p></dd>


<dt>n_near</dt>
<dd><p>The number of nearest neighbor (nn) replacement sites.
If the sampling design is unstratified, <code>n_near</code> is integer from <code>1</code>
to <code>10</code> specifying the number of
nn replacement sites to be selected for each base site. If the sampling design
is stratified but the same number of nn replacement sites is desired
for each stratum,  <code>n_near</code> is integer from <code>1</code>
to <code>10</code> specifying the number of
nn replacement sites to be selected for each base site. If the sampling design is
unstratified and a different number of nn replacement sites is
desired for each stratum, <code>n_near</code> is a vector (or list) whose names represent strata and whose
values is integer from <code>1</code>
to <code>10</code> specifying the number of
nn replacement sites to be selected for each base site in the stratum. If replacement sites
are not desired for a particular stratum, then the corresponding value in <code>n_over</code>
should be <code>0</code> or <code>NULL</code> (which is equivalent to <code>0</code>). For
infinite sampling frames, the distance between a site and its nn
depends on <code>pt_density</code>. The larger <code>pt_density</code>, the closer the nn neighbors.</p></dd>


<dt>wgt_units</dt>
<dd><p>The units used to compute the design weights. These
units must be standard units as defined by the <code>set_units()</code> function in
the units package. The default units match the units of the sf object.</p></dd>


<dt>pt_density</dt>
<dd><p>A positive integer controlling the density of the GRTS approximation
for infinite sampling frames. The GRTS approximation for infinite sample
frames vastly improves computational efficiency by generating many finite points and
selecting a sample from the points. <code>pt_density</code> represents the density
of finite points per unit to use in the approximation. More specifically,
for each stratum, the number of points used in the approximation equals
<code>pt_density * (n_base + n_over)</code>. A larger value of <code>pt_density</code>
means a closer approximation to the infinite sampling frame but less
computational efficiency. The default value of <code>pt_density</code> is <code>10</code>. Note that
when used with <code>caty_n</code>, the unequal inclusion probabilities generated from
this approach are also approximations.</p></dd>


<dt>DesignID</dt>
<dd><p>A character string indicating the naming structure for each
site's identifier selected in the sample, which is matched with <code>SiteBegin</code> and
included as a variable in the
sf object in the function's output. Default is "Site".</p></dd>


<dt>SiteBegin</dt>
<dd><p>A character string indicating the first number to use to match
with <code>DesignID</code> while creating each site's identifier selected in the sample.
Successive sites are given successive integers. The default starting number
is <code>1</code> and the number of digits is equal to number of digits in
<code>nbase + nover</code>.
For example, if <code>nbase</code> is 50 and <code>nover</code> is 0, then the default
site identifiers are <code>Site-01</code> to <code>Site-50</code></p></dd>


<dt>sep</dt>
<dd><p>A character string that acts as a separator between
<code>DesignID</code> and <code>SiteBegin</code>. The default is <code>"-"</code>.</p></dd>


<dt>projcrs_check</dt>
<dd><p>A check for whether the coordinates are projected. If <code>TRUE</code>,
an error is returned if coordinates are not projected  (i.e., they are geographic or NA). If <code>FALSE</code>, the
check is not performed, which means that the crs in <code>sframe</code> (and <code>legacy_sites</code> if provided) can be projected, geographic, or NA.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The sampling design sites and additional information about the sampling design. More specifically, it is, a list with five elements:</p>
<p></p>
<ul><li><p><code>sites_legacy</code> An sf object containing legacy sites. This is
      <code>NULL</code> if legacy sites were not included in the sample.</p></li>
<li><p><code>sites_base</code> An sf object containing the base sites. This is <code>NULL</code>
    if <code>n_base</code> equals the number of legacy sites.</p></li>
<li><p><code>sites_over</code> An sf object containing the reverse hierarchically
      ordered replacement sites. This is <code>NULL</code> if no reverse hierarchically
      ordered replacement sites were included in the sample.</p></li>
<li><p><code>sites_near</code> An sf object containing the nearest neighbor
      replacement sites. This is <code>NULL</code> if no nearest neighbor replacement
      sites were included in the sample.</p></li>
<li><p><code>design</code> A list documenting the specifications of this sampling design.
      This can be checked to verify your sampling design ran as intended.</p><ul><li><p><code>call</code> The original function call.</p></li>
<li><p><code>stratum_var</code> The name of the stratification variable in <code>sframe</code>.
          This equals <code>NULL</code> if no stratification is used.</p></li>
<li><p><code>stratum</code> The unique strata. This equals <code>"None"</code> if
          the sampling design is unstratified.</p></li>
<li><p><code>n_base</code> The base sample size per stratum.</p></li>
<li><p><code>seltype</code> The selection type per stratum.</p></li>
<li><p><code>caty_var</code> The name of the unequal probability variable in <code>sframe</code>.
          This equals <code>NULL</code> if no unequal probability variable is used.</p></li>
<li><p><code>caty_n</code> The expected sample sizes for each level of the
          unequal probability grouping variable per stratum. This equals
          <code>NULL</code> when <code>seltype</code> is not <code>"unequal"</code>.</p></li>
<li><p><code>aux_var</code> The name of the proportional probability (auxiliary) variable in <code>sframe</code>.
          This equals <code>NULL</code> if no proportional probability variable is used.</p></li>
<li><p><code>legacy</code> A logical variable indicating whether legacy sites
          were included in the sample.</p></li>
<li><p><code>legacy_stratum_var</code> The name of the stratification variable in <code>legacy_sites</code>.
          Omitted if legacy sites are not used. This equals <code>NULL</code> if legacy sites were used but
          no stratification variable is used.</p></li>
<li><p><code>legacy_caty_var</code> The name of the unequal probability variable in <code>legacy_sites</code>.
          Omitted if legacy sites are not used. This equals <code>NULL</code> if legacy sites were used but
          no unequal probability variable is used.</p></li>
<li><p><code>legacy_aux_var</code> The name of the proportional probability (auxiliary)
          variable in <code>legacy_sites</code>.
          Omitted if legacy sites are not used. This equals <code>NULL</code> if legacy sites
          were used but no proportional probability variable is used.</p></li>
<li><p><code>mindis</code> The minimum distance requirement desired. This
          is <code>NULL</code> when no minimum distance requirement was applied.</p></li>
<li><p><code>n_over</code> The reverse hierarchically ordered replacement
          site sample sizes per stratum. If <code>seltype</code> is <code>unequal</code>,
          this represents the expected sample sizes. This is <code>NULL</code>
          when no reverse hierarchically ordered replacement sites were selected.</p></li>
<li><p><code>n_near</code> The number of nearest neighbor replacement sites
          desired. This is <code>NULL</code> when no nearest neighbor replacement
          sites were selected.</p></li>
</ul></li>
</ul><p>When non-<code>NULL</code>, the <code>sites_legacy</code>, <code>sites_base</code>,</p>
<p></p>
<p><code>sites_over</code>, and <code>sites_near</code> objects contain the original columns
  in <code>sframe</code> and include a few additional columns. These additional columns
  are</p>
<p></p>
<ul><li><p><code>siteID</code> A site identifier (as named using the <code>DesignID</code>
      and <code>SiteBegin</code> arguments to <code><a href="grts.html">grts()</a></code>).</p></li>
<li><p><code>siteuse</code> Whether the site is a legacy site (<code>Legacy</code>), base
      site (<code>Base</code>), reverse hierarchically ordered replacement site
      (<code>Over</code>), or nearest neighbor replacement site (<code>Near</code>).</p></li>
<li><p><code>replsite</code> The replacement site ordering. <code>replsite</code> is
      <code>None</code> if the site is not a replacement site, <code>Next</code> if it is
      the next reverse hierarchically ordered replacement site to use, or
      <code>Near_</code>, where the word following <code>_</code> indicates the ordering of sites closest to
      the originally sampled site.</p></li>
<li><p><code>lon_WGS84</code> Longitude coordinates using the WGS84 coordinate
      system (EPSG:4326). Only given if coordinates are projected.</p></li>
<li><p><code>lat_WGS84</code> Latitude coordinates using the WGS84 coordinate
      system (EPSG:4326). Only given if coordinates are projected.</p></li>
<li><p><code>X</code> Longitude coordinates using the provided coordinate
      system. Only given if coordinates are not projected (i.e., they are geographic or NA).</p></li>
<li><p><code>Y</code> Latitude coordinates using the provided coordinate
      system. Only given if coordinates are not projected (i.e., they are geographic or NA).</p></li>
<li><p><code>stratum</code> A stratum indicator. <code>stratum</code> is <code>None</code>
      if the sampling design was unstratified. If the sampling design was <code>stratified</code>,
      <code>stratum</code> indicates the stratum.</p></li>
<li><p><code>wgt</code> The design weight.</p></li>
<li><p><code>ip</code> The site's original inclusion probability (the reciprocal)
      of (<code>wgt</code>).</p></li>
<li><p><code>caty</code> An unequal probability grouping indicator. <code>caty</code>
      is <code>None</code> if the sampling design did not use unequal inclusion probabilities.
      If the sampling design did use unequal inclusion probabilities, <code>caty</code>
      indicates the unequal probability level.</p></li>
<li><p><code>aux</code> The auxiliary proportional probability variable. This
      column is only returned if <code>seltype</code> was <code>proportional</code> in the
      original sampling design.</p></li>
</ul><p>If any columns in <code>sframe</code> contain these names, those columns
  from <code>sframe</code> will be automatically prefixed with <code>sframe_</code></p>


<p>in the <code>sites</code> object. When output is printed, a summary of site counts by
  the levels in <code>stratum_var</code> and <code>caty_var</code> is shown.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>n_base</code> is the number of sites used to calculate
  the design weights, which is typically the number of sites used in an analysis. When a panel sampling design is implemented, <code>n_base</code> is typically the
  number of sites in all panels that will be sampled in the same temporal period --
  <code>n_base</code> is not the total number of sites in all panels. The sum of <code>n_base</code> and
  <code>n_over</code> is equal to the total number of sites to be visited for all panels plus
  any replacement sites that may be required.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<dl><dt><code><a href="grts.html">grts</a></code></dt>
<dd><p>to select a sample that is spatially balanced</p></dd>

 
</dl></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tony Olsen <a href="mailto:olsen.tony@epa.gov">olsen.tony@epa.gov</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu">irs</span><span class="op">(</span><span class="va">NE_Lakes</span>, n_base <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strata_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>low <span class="op">=</span> <span class="fl">25</span>, high <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samp_strat</span> <span class="op">&lt;-</span> <span class="fu">irs</span><span class="op">(</span><span class="va">NE_Lakes</span>, n_base <span class="op">=</span> <span class="va">strata_n</span>, stratum_var <span class="op">=</span> <span class="st">"ELEV_CAT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">samp_strat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samp_over</span> <span class="op">&lt;-</span> <span class="fu">irs</span><span class="op">(</span><span class="va">NE_Lakes</span>, n_base <span class="op">=</span> <span class="fl">30</span>, n_over <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">samp_over</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Dumelle, Tom Kincaid, Tony Olsen, Marc Weber.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

