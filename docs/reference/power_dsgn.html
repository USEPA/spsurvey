<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power calculation for multiple panel designs — power_dsgn • spsurvey</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power calculation for multiple panel designs — power_dsgn"><meta property="og:description" content="Calculates the power for trend detection for one or more variables, for one
or more panel designs, for one or more linear trends, and for one or more
significance levels.  The panel designs create a covariance model where the
model includes variance components for units, periods, the interaction of
units and periods, and the residual (or index) variance."><meta property="og:image" content="https://usepa.github.io/spsurvey/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spsurvey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/start-here.html">Start Here</a>
    </li>
    <li>
      <a href="../articles/EDA.html">Summarizing and Visualizing Sampling Frames, Design Sites, and Analysis Data</a>
    </li>
    <li>
      <a href="../articles/sampling.html">Spatially Balanced Sampling</a>
    </li>
    <li>
      <a href="../articles/analysis.html">Analyzing Data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USEPA/spsurvey/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power calculation for multiple panel designs</h1>
    <small class="dont-index">Source: <a href="https://github.com/USEPA/spsurvey/blob/HEAD/R/power_dsgn.R" class="external-link"><code>R/power_dsgn.R</code></a></small>
    <div class="hidden name"><code>power_dsgn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the power for trend detection for one or more variables, for one
or more panel designs, for one or more linear trends, and for one or more
significance levels.  The panel designs create a covariance model where the
model includes variance components for units, periods, the interaction of
units and periods, and the residual (or index) variance.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power_dsgn</span><span class="op">(</span></span>
<span>  <span class="va">ind_names</span>,</span>
<span>  <span class="va">ind_values</span>,</span>
<span>  <span class="va">unit_var</span>,</span>
<span>  <span class="va">period_var</span>,</span>
<span>  <span class="va">unitperiod_var</span>,</span>
<span>  <span class="va">index_var</span>,</span>
<span>  unit_rho <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  period_rho <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">paneldsgn</span>,</span>
<span>  nrepeats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trend_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ind_pct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ind_tail <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trend <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ind_names</dt>
<dd><p>Vector of indicator names</p></dd>


<dt>ind_values</dt>
<dd><p>Vector of indicator mean values</p></dd>


<dt>unit_var</dt>
<dd><p>Vector of variance component estimates for unit variability
for the indicators</p></dd>


<dt>period_var</dt>
<dd><p>Vector of variance component estimates for period
variability for the indicators</p></dd>


<dt>unitperiod_var</dt>
<dd><p>Vector of variance component estimates for unit by
period interaction variability for the indicators</p></dd>


<dt>index_var</dt>
<dd><p>Vector of variance component estimates for index (residual)
error for the indicators</p></dd>


<dt>unit_rho</dt>
<dd><p>Correlation across units. Default is <code>1</code>.</p></dd>


<dt>period_rho</dt>
<dd><p>Correlation across periods. Default is <code>0</code>.</p></dd>


<dt>paneldsgn</dt>
<dd><p>A list of panel designs each as a matrix.  Each element of
the list is a matrix with <code>dimnames</code> (dimensions: number of panels (rows) by
number of periods (columns)) containing the number of units visited for
each combination of panel and period.  Dimnames for columns must be
able to be coerced into an integer (e.g., 2016).  All designs must span the same
number of periods.  Typically, the panel designs are the output of the
function <code>revisit_dsgn</code>.</p></dd>


<dt>nrepeats</dt>
<dd><p>Either <code>NULL</code> or a list of matrices the same length as
<code>paneldsgn</code> specifying the number of revisits made to units in a panel in the
same period for each design.  Specifying <code>NULL</code> indicates that number of
revisits to units is the same for all panels and for all periods and for
all panel designs. The default is <code>NULL</code>, a single visit. Names must match
list names in <code>paneldsgn</code>.</p></dd>


<dt>trend_type</dt>
<dd><p>Trend type is either <code>"mean"</code> where trend is applied as
percent trend in the indicator mean or <code>"percent"</code> where the trend is applied
as percent trend in the proportion (percent) of the distribution that is
below or above a fixed value. Default is <code>trend_type="mean"</code></p></dd>


<dt>ind_pct</dt>
<dd><p>When <code>trend_type</code> is equal to <code>"percent"</code>, a vector of the
values of the indicator fixed value that defines the percent.  Default is
NULL</p></dd>


<dt>ind_tail</dt>
<dd><p>When trend_type is equal to <code>"percent"</code>, a character vector
with values of either <code>"lower"</code> or <code>"upper"</code> for each indicator.  <code>"lower"</code>
states that the percent is associated with the lower tail of the
distribution and <code>"upper"</code> states that the percent is associated with the
upper tail of the distribution. Default is <code>NULL</code>.</p></dd>


<dt>trend</dt>
<dd><p>Single value or vector of assumed percent change from
initial value in the indicator for each period. Assumes the trend is
expressed as percent per period. Note that the trend may be either positive
or negative. The default is <code>2</code>.</p></dd>


<dt>alpha</dt>
<dd><p>Single value or vector of significance level for linear
trend test, alpha, Type I error, level.  The default is <code>0.05</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with components <code>trend_type</code>, <code>ind_pct</code>, <code>ind_tail</code>, trend values
  across periods, periods (all periods included in one or more panel
  designs), significance levels, a five-dimensional array of power
  calculations (dimensions: panel, design names, periods, indicator names,
  trend names, <code>alpha_names</code>), an array of indicator mean values for each trend
  and the function call.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Calculates the power for detecting a change in the mean for
  different panel design structures. The model incorporates unit, period,
  unit by period, and index variance components as well as correlation across
  units and across periods.  See references for methods.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Urquhart, N. S., W. S. Overton, et al. (1993) Comparing sampling designs
  for monitoring ecological status and trends: impact of temporal patterns.
  In: <em>Statistics for the Environment.</em> V. Barnett and K. F. Turkman.
  John Wiley &amp; Sons, New York, pp. 71-86.</p>
<p>Urquhart, N. S. and T. M. Kincaid (1999). Designs for detecting trends
  from repeated surveys of ecological resources. <em>Journal of
  Agricultural, Biological, and Environmental Statistics</em>, <b>4(4)</b>,
  404-414.</p>
<p>Urquhart, N. S. (2012). The role of monitoring design in detecting trend in
  long-term ecological monitoring studies. In: <em>Design and Analysis of
  Long-term Ecological Monitoring Studies.</em> R. A. Gitzen, J. J. Millspaugh,
  A. B. Cooper, and D. S. Licht (eds.). Cambridge University Press, New York,
  pp. 151-173.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<dl><dt><code><a href="ppd_plot.html">ppd_plot</a></code></dt>
<dd><p>to plot power curves for
      panel designs</p></dd>

  
</dl></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tony Olsen <a href="mailto:Olsen.Tony@epa.gov">Olsen.Tony@epa.gov</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Power for rotating panel with sample size 60</span></span></span>
<span class="r-in"><span><span class="fu">power_dsgn</span><span class="op">(</span><span class="st">"Variable_Name"</span>,</span></span>
<span class="r-in"><span>  ind_values <span class="op">=</span> <span class="fl">43</span>, unit_var <span class="op">=</span> <span class="fl">280</span>, period_var <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  unitperiod_var <span class="op">=</span> <span class="fl">40</span>, index_var <span class="op">=</span> <span class="fl">90</span>, unit_rho <span class="op">=</span> <span class="fl">1</span>, period_rho <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  paneldsgn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NoR60 <span class="op">=</span> <span class="fu"><a href="revisit_dsgn.html">revisit_dsgn</a></span><span class="op">(</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    panels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NoR60 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      n <span class="op">=</span> <span class="fl">60</span>, pnl_dsgn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      pnl_n <span class="op">=</span> <span class="cn">NA</span>, start_option <span class="op">=</span> <span class="st">"None"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>, begin <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrepeats <span class="op">=</span> <span class="cn">NULL</span>, trend_type <span class="op">=</span> <span class="st">"mean"</span>, trend <span class="op">=</span> <span class="fl">1.0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $design</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NoR60"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $period</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $indicator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variable_Name"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trend_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trend_change</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Variable_Name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1     2     3     4     5     6     7     8     9    10   11    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend_1% 43 43.43 43.86 44.29 44.72 45.15 45.58 46.01 46.44 46.87 47.3 47.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             13    14    15    16    17    18    19    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend_1% 48.16 48.59 49.02 49.45 49.88 50.31 50.74 51.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dsgn_power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Variable_Name, Trend_1%, alpha_0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5         6       7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NoR60 0.05 0.05097814 0.05391947 0.05983234 0.06977159 0.0848596 0.10629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               8         9        10        11       12        13        14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NoR60 0.1352933 0.1730432 0.2204875 0.2781082 0.345641 0.4218213 0.5042486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             15        16        17        18        19        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NoR60 0.589462 0.6732835 0.7514024 0.8200819 0.8767933 0.9205846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power_dsgn("Variable_Name", ind_values = 43, unit_var = 280, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     period_var = 4, unitperiod_var = 40, index_var = 90, unit_rho = 1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     period_rho = 0, paneldsgn = list(NoR60 = revisit_dsgn(20, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         panels = list(NoR60 = list(n = 60, pnl_dsgn = c(1, NA), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             pnl_n = NA, start_option = "None")), begin = 1)), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nrepeats = NULL, trend_type = "mean", trend = 1, alpha = 0.05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "powerpaneldesign"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Dumelle, Tom Kincaid, Tony Olsen, Marc Weber.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

